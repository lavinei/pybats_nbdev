---

title: DGLM

keywords: fastai
sidebar: home_sidebar

summary: "The class Dynamic Generalized Linear Model (DGLM), which is the core of the PyBATS package."
description: "The class Dynamic Generalized Linear Model (DGLM), which is the core of the PyBATS package."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_dglm.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The PyBATS library supports many types of DGLMs - Poisson, Bernoulli, Normal (a DLM), and Binomial. These models are based upon <a href="http://www2.stat.duke.edu/~mw/West&amp;HarrisonBook/"><em>Bayesian Forecasting and Dynamic Models</em></a>, by West and Harrison (1997).</p>
<p>A Dynamic Generalized Linear Model is defined by:</p>
<ul>
<li>The exponential family of the observations Y: Normal, Poisson, Bernoulli, or Binomial</li>
<li>The components in the state vector: Trend, Regression, Seasonal, Holiday, and Latent Factor</li>
</ul>
<p>A DGLM is a linear state space model, defined by the dynamic regression:</p>
$$
\begin{aligned}
y_t &amp;\sim p(\lambda_t) \\
\lambda_{t} &amp;= F_{t}' \theta_{t}
\end{aligned}
$$<p>Where:</p>
<ul>
<li>$p(\lambda_t)$ is the forecast distribution for the observation $y_t$</li>
<li>$\theta_t$ is the state vector</li>
<li>$F_t$ is the regression vector, containing all of the predictors $X_t$</li>
</ul>
<p>A PyBATS DGLM has three core methods. <a href="/pybats_nbdev/update"><code>update</code></a> will update the state vector $\theta_t$ after observing $y_t$. <a href="/pybats_nbdev/forecast#forecast_marginal"><code>forecast_marginal</code></a> simulates from the forecast distribution for $y$ at $k$ time steps into the future. <a href="/pybats_nbdev/forecast#forecast_path"><code>forecast_path</code></a> simulates from the forecast distribution for $y$ from today through to $k$ steps into the future.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="DGLM-Class">DGLM Class<a class="anchor-link" href="#DGLM-Class"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="dglm" class="doc_header"><code>class</code> <code>dglm</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/dglm.py#L28" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>dglm</code>(<strong><code>a0</code></strong>=<em><code>None</code></em>, <strong><code>R0</code></strong>=<em><code>None</code></em>, <strong><code>nregn</code></strong>=<em><code>0</code></em>, <strong><code>ntrend</code></strong>=<em><code>0</code></em>, <strong><code>nlf</code></strong>=<em><code>0</code></em>, <strong><code>nhol</code></strong>=<em><code>0</code></em>, <strong><code>seasPeriods</code></strong>=<em><code>[]</code></em>, <strong><code>seasHarmComponents</code></strong>=<em><code>[]</code></em>, <strong><code>deltrend</code></strong>=<em><code>1</code></em>, <strong><code>delregn</code></strong>=<em><code>1</code></em>, <strong><code>dellf</code></strong>=<em><code>1</code></em>, <strong><code>delhol</code></strong>=<em><code>1</code></em>, <strong><code>delseas</code></strong>=<em><code>1</code></em>, <strong><code>rho</code></strong>=<em><code>1</code></em>, <strong><code>interpolate</code></strong>=<em><code>True</code></em>, <strong><code>adapt_discount</code></strong>=<em><code>False</code></em>, <strong><code>adapt_factor</code></strong>=<em><code>0.5</code></em>, <strong><code>discount_forecast</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Core class of dynamic generalized linear models (DGLMs).</p>
<p>Children include Poisson, Bernoulli, and Binomial DGLMs, as well as the Normal DLM.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below is a very simple example of manually defining a DGLM. However, in most situations, DGLMs will be defined automatically through <a href="/pybats_nbdev/analysis"><code>analysis</code></a> or through <a href="/pybats_nbdev/define_models"><code>define_models</code></a>.</p>
<p>This model has 1 trend coefficent and 2 regression coefficients. The trend is simply an intercept. The 2 regression coefficients mean that we have 2 predictor variables.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pybats_nbdev.dglm</span> <span class="kn">import</span> <span class="n">pois_dglm</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">pois_dglm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">ntrend</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nregn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">deltrend</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delregn</span><span class="o">=.</span><span class="mi">9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>a</strong> and <strong>R</strong> are the mean vector and variance matrix of the state vector $\theta$.</p>
<p><code>deltrend</code> is the discount factor on the trend component. A discount factor of 1 indicates no expected change over time.</p>
<p><code>delregn</code> is the discount factor on the regression component. A discount factor of 0.9 indicates that we expect about a 10% change in the coefficient every time step. This is a very low discount factor. Most of the time, discount factors should be set between $0.95 - 1$.</p>
<p>Discounting old information is what makes this model <em>dynamic</em>, because we are telling the model that the coefficients should change over time.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dglm.update" class="doc_header"><code>dglm.update</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/dglm.py#L251" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dglm.update</code>(<strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>X</code></strong>=<em><code>None</code></em>, <strong><code>phi_mu</code></strong>=<em><code>None</code></em>, <strong><code>phi_sigma</code></strong>=<em><code>None</code></em>, <strong><code>analytic</code></strong>=<em><code>True</code></em>, <strong><code>phi_samps</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Update the DGLM state vector mean and covariance after observing 'y', with covariates 'X'.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will make up an observation $y$ and predictors $X$ and demonstrate how the model updates:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">mod</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below, we'll see how the mean and variance of the state vector $\theta_t$ has now changed from the initial definition.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">R</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[0.6],
        [0.6],
        [0.2]]),
 array([[ 0.84, -0.16, -0.32],
        [-0.16,  0.93, -0.36],
        [-0.32, -0.36,  0.4 ]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dglm.forecast_marginal" class="doc_header"><code>dglm.forecast_marginal</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/dglm.py#L266" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dglm.forecast_marginal</code>(<strong><code>k</code></strong>, <strong><code>X</code></strong>=<em><code>None</code></em>, <strong><code>nsamps</code></strong>=<em><code>1</code></em>, <strong><code>mean_only</code></strong>=<em><code>False</code></em>, <strong><code>phi_mu</code></strong>=<em><code>None</code></em>, <strong><code>phi_sigma</code></strong>=<em><code>None</code></em>, <strong><code>analytic</code></strong>=<em><code>True</code></em>, <strong><code>phi_samps</code></strong>=<em><code>None</code></em>, <strong><code>state_mean_var</code></strong>=<em><code>False</code></em>, <strong><code>y</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Simulate from the forecast distribution at time <em>t+k</em>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can forecast from this model using future values of our predictors, <code>X_future</code>. The output are simulated values from the forecast distribution.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_future</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">forecast_samples</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">forecast_marginal</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">X_future</span><span class="p">,</span> <span class="n">nsamps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">forecast_samples</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 1, 26,  0,  7,  0, 23,  3, 16, 25,  1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dglm.forecast_path" class="doc_header"><code>dglm.forecast_path</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/dglm.py#L281" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dglm.forecast_path</code>(<strong><code>k</code></strong>, <strong><code>X</code></strong>=<em><code>None</code></em>, <strong><code>nsamps</code></strong>=<em><code>1</code></em>, <strong><code>copula</code></strong>=<em><code>True</code></em>, <strong><code>phi_mu</code></strong>=<em><code>None</code></em>, <strong><code>phi_sigma</code></strong>=<em><code>None</code></em>, <strong><code>phi_psi</code></strong>=<em><code>None</code></em>, <strong><code>analytic</code></strong>=<em><code>True</code></em>, <strong><code>phi_samps</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Simulate from the path forecast (the joint forecast) distribution from <em>1</em> to <em>k</em> steps ahead.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Path forecasting is used for forecast over multiple step steps at once. For example, let's forecast the next 3 time steps. <code>X_future</code> is still the future values of our predictors, but it now has 3 rows.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_future</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">forecast_samples</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">forecast_path</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">X_future</span><span class="p">,</span> <span class="n">nsamps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">forecast_samples</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 4,  3,  2],
       [11,  9,  8],
       [ 5,  3,  1],
       [13,  8,  8],
       [ 2,  0,  2],
       [ 8,  5,  2],
       [24, 32, 12],
       [ 3,  7,  3],
       [ 4,  1,  1],
       [10,  1,  6]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="bern_dglm" class="doc_header"><code>class</code> <code>bern_dglm</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/dglm.py#L344" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>bern_dglm</code>(<strong><code>a0</code></strong>=<em><code>None</code></em>, <strong><code>R0</code></strong>=<em><code>None</code></em>, <strong><code>nregn</code></strong>=<em><code>0</code></em>, <strong><code>ntrend</code></strong>=<em><code>0</code></em>, <strong><code>nlf</code></strong>=<em><code>0</code></em>, <strong><code>nhol</code></strong>=<em><code>0</code></em>, <strong><code>seasPeriods</code></strong>=<em><code>[]</code></em>, <strong><code>seasHarmComponents</code></strong>=<em><code>[]</code></em>, <strong><code>deltrend</code></strong>=<em><code>1</code></em>, <strong><code>delregn</code></strong>=<em><code>1</code></em>, <strong><code>dellf</code></strong>=<em><code>1</code></em>, <strong><code>delhol</code></strong>=<em><code>1</code></em>, <strong><code>delseas</code></strong>=<em><code>1</code></em>, <strong><code>rho</code></strong>=<em><code>1</code></em>, <strong><code>interpolate</code></strong>=<em><code>True</code></em>, <strong><code>adapt_discount</code></strong>=<em><code>False</code></em>, <strong><code>adapt_factor</code></strong>=<em><code>0.5</code></em>, <strong><code>discount_forecast</code></strong>=<em><code>False</code></em>) :: <a href="/pybats_nbdev/dglm"><code>dglm</code></a></p>
</blockquote>
<p>Core class of dynamic generalized linear models (DGLMs).</p>
<p>Children include Poisson, Bernoulli, and Binomial DGLMs, as well as the Normal DLM.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A Bernoulli DGLM models $0-1$ observations:</p>
$$
\begin{aligned}
y_t &amp;\sim Bern(\pi_t) \\
\pi_t &amp;= 1/(1 + e^{-\lambda_t}) \\
\lambda_{t} &amp;= F_{t}' \theta_{t}
\end{aligned}
$$<p>Where</p>
<ul>
<li>Bern($\pi_t$) is the <a href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernoulli distribution</a> with probability $\pi_t$</li>
<li>$\lambda_t$ is transformed through the <a href="https://en.wikipedia.org/wiki/Logistic_function">logistic function</a> to become $\pi_t$</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="pois_dglm" class="doc_header"><code>class</code> <code>pois_dglm</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/dglm.py#L397" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>pois_dglm</code>(<strong><code>a0</code></strong>=<em><code>None</code></em>, <strong><code>R0</code></strong>=<em><code>None</code></em>, <strong><code>nregn</code></strong>=<em><code>0</code></em>, <strong><code>ntrend</code></strong>=<em><code>0</code></em>, <strong><code>nlf</code></strong>=<em><code>0</code></em>, <strong><code>nhol</code></strong>=<em><code>0</code></em>, <strong><code>seasPeriods</code></strong>=<em><code>[]</code></em>, <strong><code>seasHarmComponents</code></strong>=<em><code>[]</code></em>, <strong><code>deltrend</code></strong>=<em><code>1</code></em>, <strong><code>delregn</code></strong>=<em><code>1</code></em>, <strong><code>dellf</code></strong>=<em><code>1</code></em>, <strong><code>delhol</code></strong>=<em><code>1</code></em>, <strong><code>delseas</code></strong>=<em><code>1</code></em>, <strong><code>rho</code></strong>=<em><code>1</code></em>, <strong><code>interpolate</code></strong>=<em><code>True</code></em>, <strong><code>adapt_discount</code></strong>=<em><code>False</code></em>, <strong><code>adapt_factor</code></strong>=<em><code>0.5</code></em>, <strong><code>discount_forecast</code></strong>=<em><code>False</code></em>) :: <a href="/pybats_nbdev/dglm"><code>dglm</code></a></p>
</blockquote>
<p>Core class of dynamic generalized linear models (DGLMs).</p>
<p>Children include Poisson, Bernoulli, and Binomial DGLMs, as well as the Normal DLM.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A Poisson DGLM models non-negative integers:</p>
$$
\begin{aligned}
y_t &amp;\sim Pois(\mu_t) \\
\mu_t &amp;= e^{\lambda_t} \\
\lambda_{t} &amp;= F_{t}' \theta_{t}
\end{aligned}
$$<p>Where</p>
<ul>
<li>Pois($\mu_t$) is the <a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson distribution</a> with rate parameter $\mu_t$</li>
<li>$\mu_t$ is exponent of $\lambda_t$</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="dlm" class="doc_header"><code>class</code> <code>dlm</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/dglm.py#L448" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>dlm</code>(<strong>*<code>args</code></strong>, <strong><code>n0</code></strong>=<em><code>1</code></em>, <strong><code>s0</code></strong>=<em><code>1</code></em>, <strong><code>delVar</code></strong>=<em><code>1</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/pybats_nbdev/dglm"><code>dglm</code></a></p>
</blockquote>
<p>Core class of dynamic generalized linear models (DGLMs).</p>
<p>Children include Poisson, Bernoulli, and Binomial DGLMs, as well as the Normal DLM.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A normal DLM has a slightly different form than other DGLMs:</p>
$$
\begin{aligned}
y_t &amp;\sim N(\mu_t, \sigma^2_t) \\
\mu_t &amp;= \lambda_{t} = F_{t}' \theta_{t}
\end{aligned}
$$<p>Where</p>
<ul>
<li>N($\mu_t, \sigma^2_t$) is the <a href="https://en.wikipedia.org/wiki/normal_distribution">Normal distribution</a> with mean $\mu_t$ and variance $\sigma^2_t$.</li>
<li>$\sigma^2_t$ is also a dynamic parameter, with its own evolution through time. The discount factor delVar isset by the modeler, and controls the rate at which $\sigma^2$ changes. Typically it is set between $0.95-1$.  </li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="bin_dglm" class="doc_header"><code>class</code> <code>bin_dglm</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/dglm.py#L499" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>bin_dglm</code>(<strong><code>a0</code></strong>=<em><code>None</code></em>, <strong><code>R0</code></strong>=<em><code>None</code></em>, <strong><code>nregn</code></strong>=<em><code>0</code></em>, <strong><code>ntrend</code></strong>=<em><code>0</code></em>, <strong><code>nlf</code></strong>=<em><code>0</code></em>, <strong><code>nhol</code></strong>=<em><code>0</code></em>, <strong><code>seasPeriods</code></strong>=<em><code>[]</code></em>, <strong><code>seasHarmComponents</code></strong>=<em><code>[]</code></em>, <strong><code>deltrend</code></strong>=<em><code>1</code></em>, <strong><code>delregn</code></strong>=<em><code>1</code></em>, <strong><code>dellf</code></strong>=<em><code>1</code></em>, <strong><code>delhol</code></strong>=<em><code>1</code></em>, <strong><code>delseas</code></strong>=<em><code>1</code></em>, <strong><code>rho</code></strong>=<em><code>1</code></em>, <strong><code>interpolate</code></strong>=<em><code>True</code></em>, <strong><code>adapt_discount</code></strong>=<em><code>False</code></em>, <strong><code>adapt_factor</code></strong>=<em><code>0.5</code></em>, <strong><code>discount_forecast</code></strong>=<em><code>False</code></em>) :: <a href="/pybats_nbdev/dglm"><code>dglm</code></a></p>
</blockquote>
<p>Core class of dynamic generalized linear models (DGLMs).</p>
<p>Children include Poisson, Bernoulli, and Binomial DGLMs, as well as the Normal DLM.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A Binomial DGLM models the sum of independent $0-1$ observations:</p>
$$
\begin{aligned}
y_t &amp;\sim Bin(n_t, pi_t) \\
\pi_t &amp;= 1/(1 + e^{-\lambda_t}) \\
\lambda_{t} &amp;= F_{t}' \theta_{t}
\end{aligned}
$$<p>Where</p>
<ul>
<li>Bin($n_t, pi_t$) is the <a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial distribution</a> with $n_t$ independent trials, each having probability $\pi_t$</li>
<li>$\lambda_t$ is transformed through the <a href="https://en.wikipedia.org/wiki/Logistic_function">logistic function</a> to become $\pi_t$</li>
</ul>

</div>
</div>
</div>
</div>
 

