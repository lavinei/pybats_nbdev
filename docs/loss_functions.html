---

title: loss_functions

keywords: fastai
sidebar: home_sidebar

summary: "This module contains standard loss functions (error metrics) given a set of observations and point forecasts."
description: "This module contains standard loss functions (error metrics) given a set of observations and point forecasts."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/08_loss_functions.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MSE" class="doc_header"><code>MSE</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/loss_functions.py#L10" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MSE</code>(<strong><code>y</code></strong>, <strong><code>f</code></strong>)</p>
</blockquote>
<p>Mean squared error (MSE).</p>
<p>.. math:: MSE(y, f) = \frac{1}{n} \sum_{i=1:n} (y_i-f_i)^2</p>
<p>The optimal point forecast to minimize the MSE is the mean.</p>
<p>.. code::</p>

<pre><code>k = 1
MSE(y[forecast_start + k - 1:forecast_end + k], mean(samples))

</code></pre>
<p>:param y: Observation vector
:param f: Point forecast vector
:return: Mean squared error (MSE)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MAD" class="doc_header"><code>MAD</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/loss_functions.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MAD</code>(<strong><code>y</code></strong>, <strong><code>f</code></strong>)</p>
</blockquote>
<p>Mean absolute deviation (MAD).</p>
<p>.. math:: MAD(y, f) = \frac{1}{n} \sum_{i=1:n} |y_i-f_i|</p>
<p>The optimal point forecast to minimize the MAD is the median.</p>
<p>.. code::</p>

<pre><code>k = 1
MAD(y[forecast_start + k - 1:forecast_end + k], median(samples))

</code></pre>
<p>:param y: Observation vector
:param f: Point forecast vector
:return: Mean absolute deviation (MAD)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MAPE" class="doc_header"><code>MAPE</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/loss_functions.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MAPE</code>(<strong><code>y</code></strong>, <strong><code>f</code></strong>)</p>
</blockquote>
<p>Mean absolute percent error (MAPE).</p>
<p>.. math:: MAPE(y, f) = \frac{1}{n} \sum_{i=1:n} |y_i-f_i| / y_i</p>
<p>The optimal point forecast to minimize the MAPE is the (-1)-median. However, it is common to use the median point forecast, which is similar.</p>
<p>.. code::</p>

<pre><code>k = 1
MAPE(y[forecast_start + k - 1:forecast_end + k], m_one_median(samples))

</code></pre>
<p>:param y: Observation vector
:param f: Point forecast vector
:return: Mean absolute percent error (MAPE)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="WAPE" class="doc_header"><code>WAPE</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/loss_functions.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>WAPE</code>(<strong><code>y</code></strong>, <strong><code>f</code></strong>)</p>
</blockquote>
<p>Weighted Absolute Percent Error (WAPE).</p>
<p>.. math:: WAPE(y, f) =  \frac{\sum_{i=1:n} |y_i-f<em>i|}{\sum</em>{i=1:n} y_i}</p>
<p>The weighted absolute percent error solves the issues of division by 0 in the MAPE.</p>
<p>The optimal point forecase to minimize the WAPE is the joint (-1)-median.</p>
<p>.. code::</p>

<pre><code>k = 1
WAPE(y[forecast_start + k - 1:forecast_end + k], joint_m_one_median(samples))

</code></pre>
<p>:param y: Observation vector
:param f: Point forecast vector
:return: Weighted absolute percent error (WAPE)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="WAFE" class="doc_header"><code>WAFE</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/loss_functions.py#L103" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>WAFE</code>(<strong><code>y</code></strong>, <strong><code>f</code></strong>)</p>
</blockquote>
<p>Weighted Absolute Forecast Error (WAFE).</p>
<p>.. math:: WAFE(y, f) =  \frac{\sum_{i=1:n} |y_i-f<em>i|}{\sum</em>{i=1:n} \frac{1}{2}(y_i + f_i)}</p>
<p>Similar to WAPE, the weighted absolute forecast error solves the issues of division by 0 in the MAPE.
It  balances between the observations (:math:<code>y_i</code>) and forecasts (:math:<code>f_i</code>) in the denominator.</p>
<p>.. code::</p>

<pre><code>k = 1
WAFE(y[forecast_start + k - 1:forecast_end + k], median(samples))

</code></pre>
<p>:param y: Observation vector
:param f: Point forecast vector
:return: Weighted absolute forecast error (WAFE)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ZAPE" class="doc_header"><code>ZAPE</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/loss_functions.py#L127" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ZAPE</code>(<strong><code>y</code></strong>, <strong><code>f</code></strong>)</p>
</blockquote>
<p>Zero-Adjusted Absolute Percent Error (ZAPE).</p>
<p>.. math:: ZAPE(y, f) = \frac{1}{n} \sum_{i=1:n} I(y_i = 0) <em> f_i + I(y_i = 1) </em> |y_i-f_i| / y_i</p>
<p>The zero-adjusted absolute percent error is an similar to absolute percent error (APE), but sets the loss equal to :math:<code>f_i</code> when :math:<code>y_i=0</code>, to avoid division by 0.</p>
<p>Finding the optimal point forecast for ZAPE requires a simple numerical optimization, and lies between the median and (-1)-median.</p>
<p>.. code::</p>

<pre><code>k = 1
ZAPE(y[forecast_start + k - 1:forecast_end + k], median(samples))

</code></pre>
<p>:param y: Observation vector
:param f: Point forecast vector
:return: The mean Zero-Adjusted absolute percent error (ZAPE)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scaledMSE" class="doc_header"><code>scaledMSE</code><a href="https://github.com/lavinei/pybats_nbdev/tree/master/pybats_nbdev/loss_functions.py#L156" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scaledMSE</code>(<strong><code>y</code></strong>, <strong><code>f</code></strong>, <strong><code>ymean</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

